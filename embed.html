<!DOCTYPE html>
<html lang="en-US">
<head>
	<!-- Inspired by https://steveoni.github.io/v4/ -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0,user-scalable=0">
	<meta name="author" content="Zane Wesley">
	<meta name="description" content="The place where you can find all of Zane's apps and projects.">
	<!-- General -->
	<link rel="manifest" href="manifest.json">
	<meta name="theme-color" content="#0a192f">
	<meta name="application-name" content="Zane's Apps">
	<link rel="shortcut icon" href="images/icon.png">
	<link rel="icon" type="image/png" sizes="500x500" href="images/icon.png">
	<link rel="canonical" href="https://www.zanewesley.github.io">
	<!-- Apple -->
	<meta name="apple-mobile-web-app-title" content="Zane's Apps">
	<meta name="apple-mobile-web-app-status-bar-style" content="#0a192f">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<link rel="apple-touch-icon" sizes="500x500" href="images/icon.png">
	<link rel="mask-icon" href="images/icon.png" color="#0a192f">
	<!-- Fonts -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;400;500;700&family=Roboto:wght@300;400;500;700&family=Roboto+Mono:wght@300;400;500&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.0.0/css/all.css" crossorigin="anonymous"/>
	<!-- Analytics -->
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-YEEGMG5QT7"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());
	  gtag('config', 'G-YEEGMG5QT7');
	</script>

	<title>Zane's Apps | Embed Player</title>

	<style>
		* {
			box-sizing: border-box;
			margin: 0;
			padding: 0;
			/*overflow-x: hidden;*/
			transition: all 0.25s cubic-bezier(0.645,0.045,0.355,1);
		}
		html, body {
			scroll-behavior: smooth;
			background-color: #0a192f;
			font-family: 'Roboto', sans-serif;
			width: 100%;
			height: auto;
			font-size: 20px;
			/*color: #8892b0; -- dark*/
			color: #ccd6f6;/*-- light*/
			/*color: #64d1ff; -- blue*/
		}

		/* width */
		::-webkit-scrollbar {
		  width: 12px;
		}

		/* Track */
		::-webkit-scrollbar-track {
		  background: #0a192f;
		}

		/* Handle */
		::-webkit-scrollbar-thumb {
		  background: #ccd6f6;
		  border-radius: 10px;
		  border: 3px solid #0a192f;
		}

		/* Handle on hover */
		::-webkit-scrollbar-thumb:hover {
		  background: #8892b0;
		}
		/* WebKit/Blink Browsers */
		::selection {
		  background: #233554;
		  color: #fff;
		}
		/* Gecko Browsers */
		::-moz-selection {
		  background: #233554;
		  color: #fff;
		}
		#standalone-frame {
			position: fixed;
			overflow-x: hidden;
			overflow-y: auto;
			left: 0;
			top: 50px;
			width: 100%;
			height: calc(100% - 50px);
			max-width: 100%;
			max-height: calc(100% - 50px);
			border: none;
			z-index: 3;
			user-select: none;
			-webkit-user-select: none;
		}
		#standalone-nav {
			position: fixed;
			z-index: 3;
			left: 0;
			top: 0;
			width: 100%;
			height: 50px;
			color: #fff;
			font-size: 1.5em;
			background-color: #0a192f;
			padding: 12px;
			display: flex;
			flex-direction: row;
			justify-content: space-between;
			align-items: center;
			overflow: hidden;
			transition: all 0.3s;
		}
		.icon {
			cursor: pointer;
		}
		#standalone-nav .icon:hover {
			color: #ccc;
		}
		#standalone-nav .username-wrapper {
			font-size: 0.5em;
		}
		.standalone-title, #standalone-nav .username-wrapper {
			color: #ccd6f6;
		}
		.standalone-title:hover {
			color: #fff;
			cursor: pointer;
		}
		.standalone-icons {
			color: #64d1ff;
		}
		#standalone-bg {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: #fff;
			z-index: 2;
		}
		/*#usernameBox {
			position: fixed;
			right: 0;
			top: 0;
			background-color: rgba(35, 53, 84, 0.7);
			padding: 0.5em 1em;
			animation: fadeIn 3s linear;
			z-index: 3;
		}
		#usernameBox .head {
			font-size: 0.5em;
		}*/
		.popup {
			position: fixed;
			/*top: 50%;*/
			bottom: 1em;
			left: 50%;
			/*transform: translate(-50%, -50%);*/
			transform: translateX(-50%);
			width: 50%;
			padding: 1em;
			height: auto;
			/*min-height: 50%;*/
			padding-bottom: 3em;
			background-color: #64d1ff;
			background: linear-gradient(169deg, rgba(100,209,255,1) 9%, rgba(10,25,47,1) 100%);
			color: #0a192f;
			border-radius: 20px;
			display: none;
			z-index: 3;
		}
		.popup.open {
			display: block;
		}
		.popup h2 {
			text-align: center;
		}
		.popup input {
			padding: 15px 30px;
		    border-radius: 8px;
		    border: none;
		    color: #0a192f;
		    background-color: #fff;
		    margin: 20px 0;
		    outline: none;
		}
		.popup button {
			padding: 15px 30px;
			border-radius: 8px;
			border: none;
			color: #ccd6f6;
			background-color: #0a192f;
			outline: none;
			cursor: pointer;
		}
		.popup button#nothanks {
			position: absolute;
			bottom: 1em;
			right: 1em;
		}
		.popup #save-loader {
			display: none;
		}

		@media (max-width: 480px) {
			.popup {
				width: 90%;
			}
			.popup input {
				width: 100%;
			}
		}
	</style>
</head>
<body>
	<iframe id="standalone-frame" class="standalone-ui" src=""></iframe>

	<div id="standalone-nav" class="standalone-ui monospace">
		<!--<div class="standalone-icons">
			<span id="standalone-home" class="icon fa-regular fa-house"></span>
			<span id="standalone-share" class="icon fa-regular fa-share"></span>
		</div>-->
		<div class="standalone-title">Zane's Apps</div>
		<div class="username-wrapper">Username: <span id="usernameBox">Guest</span></div>
	</div>

	<!--<div id="usernameBox">
		<div class="head">Username:</div>
		<div class="user"></div>
	</div>-->

	<div id="standalone-bg" class="standalone-ui"></div>

	<div class="popup">
		<h2>Want to Get Recognized?</h2>
		<p>Enter a username below to associate with your scores on the leaderboard!</p>
		<input type="text" id="username" placeholder="Username" class="monospace">
		<button id="nothanks">No Thanks</button>
		<button id="saveuser">Save Username</button>
		<img id="save-loader" src="images/game-loader.svg" alt="Saving username loader">
	</div>

	<script src="leaderboard-handler.js"></script>

	<script>
		var leaderboardName = localStorage.getItem('z_leaderboard_username');
		if(!leaderboardName) {
			leaderboardName = 'Guest-'+__makeId__(5);
			setTimeout(function() {
				document.querySelector('.popup').classList.add('open');
			}, 5000);
		}
		document.getElementById('usernameBox').innerHTML = leaderboardName;

		function loadIFrame(url) {
			var iFrame = document.getElementById('standalone-frame');
			iFrame.src=url;
			var fdt = iFrame.contentWindow.document.title;
			if(fdt) document.title = fdt;
			console.log(fdt);
		}

		/*document.getElementById('standalone-frame').addEventListener("DOMAttrModified", function(event) {
		    if (event.attrName == "src") {
		       // The "src" attribute changed
		       document.title = document.getElementById('standalone-frame').contentDocument.title;
		       console.log('iframe url changed');
		    }
		});*/

		let params = new URLSearchParams(document.location.search);
		let dataUrl = params.get("data-url");
		if(dataUrl) {
			loadIFrame(dataUrl);
		} else {
			loadIFrame('/');
		}

		document.getElementById('nothanks').addEventListener('click', function(e) {
			e.preventDefault();
			this.parentNode.classList.remove('open');
		});

		document.getElementById('saveuser').addEventListener('click', function(e) {
			e.preventDefault();
			setUsername();
			//this.parentNode.classList.remove('open');
		});

		document.querySelector('.standalone-title').addEventListener('click', function(e) {
			window.location = '/';
		});

		function setUsername() {
			if(document.getElementById('username').value != "" && document.getElementById('username').value != null) {
				document.querySelectorAll('h2, p, input, button').forEach(function(elem) {
					elem.style.display="none";
				});
				document.getElementById('save-loader').style.display="block";
				localStorage.setItem('z_leaderboard_username', String(document.getElementById('username').value));
				setTimeout(function() {
					document.querySelector('.popup').classList.remove('open');
					displayUsername(String(document.getElementById('username').value));
					leaderboardName = String(document.getElementById('username').value);
					document.getElementById('usernameBox').innerHTML = leaderboardName;
				}, 3000);
			} else {
				document.querySelector('.popup p').innerHTML="Please enter a valid username.";
			}
		}

		function displayUsername(user) {
			document.getElementById('usernameBox').innerHTML=user;
		}
	</script>
</body>
</html>
